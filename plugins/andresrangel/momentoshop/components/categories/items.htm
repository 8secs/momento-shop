{% for category in categories %}
{% set postCount = category.products.count %}

<li {% if category.slug == currentCategorySlug %}class="active"{% endif %}>
    <a href="{{ category.url }}">{{ category.name }}
    {% if postCount %}
    <span class="badge">{{ postCount }}</span>
    {% endif %}
    </a>
    {% if category.children %}
    <ul>
        {% partial __SELF__ ~ "::items"
        categories=category.children
        currentCategorySlug=currentCategorySlug
        %}
    </ul>
    {% endif %}
</li>
{% endfor %}
